



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-2.7.3">
    
    
      
        <title>Methodology - GME Package Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.8d40d89b.css">
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#gravity-estimation-methodology" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="GME Package Documentation" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                GME Package Documentation
              </span>
              <span class="md-header-nav__topic">
                Methodology
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    GME Package Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../getting_started/" title="Getting started" class="md-nav__link">
      Getting started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../estimation_tutorial/" title="Estimation" class="md-nav__link">
      Estimation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Methodology
      </label>
    
    <a href="./" title="Methodology" class="md-nav__link md-nav__link--active">
      Methodology
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#theory-based-gravity-equation" title="Theory-based gravity equation" class="md-nav__link">
    Theory-based gravity equation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#estimation-procedure" title="Estimation Procedure" class="md-nav__link">
    Estimation Procedure
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#technical-details-of-ppml-implementation" title="Technical Details of PPML Implementation" class="md-nav__link">
    Technical Details of PPML Implementation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#non-existence-of-estimates" title="Non-existence of estimates" class="md-nav__link">
    Non-existence of estimates
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#non-convergence" title="Non-convergence" class="md-nav__link">
    Non-convergence
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      API Reference
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        API Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-1" type="checkbox" id="nav-5-1">
    
    <label class="md-nav__link" for="nav-5-1">
      Data Construction
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-1">
        Data Construction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../api_docs/EstimationData/" title="EstimationData" class="md-nav__link">
      EstimationData
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-2" type="checkbox" id="nav-5-2">
    
    <label class="md-nav__link" for="nav-5-2">
      Model Estimation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-2">
        Model Estimation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../api_docs/EstimationModel/" title="EstimationModel" class="md-nav__link">
      EstimationModel
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api_docs/estimate_method/" title="estimate" class="md-nav__link">
      estimate
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api_docs/format_regression_table/" title="format_regression_table" class="md-nav__link">
      format_regression_table
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api_docs/combine_sector_results/" title="combine_sector_results" class="md-nav__link">
      combine_sector_results
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api_docs/load_estimation/" title="load_estimation" class="md-nav__link">
      load_estimation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api_docs/save_estimation/" title="save_estimation" class="md-nav__link">
      save_estimation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api_docs/SlimResults/" title="SlimResults" class="md-nav__link">
      SlimResults
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../about/" title="About" class="md-nav__link">
      About
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#theory-based-gravity-equation" title="Theory-based gravity equation" class="md-nav__link">
    Theory-based gravity equation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#estimation-procedure" title="Estimation Procedure" class="md-nav__link">
    Estimation Procedure
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#technical-details-of-ppml-implementation" title="Technical Details of PPML Implementation" class="md-nav__link">
    Technical Details of PPML Implementation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#non-existence-of-estimates" title="Non-existence of estimates" class="md-nav__link">
    Non-existence of estimates
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#non-convergence" title="Non-convergence" class="md-nav__link">
    Non-convergence
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>

<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-MML-AM_CHTML' async></script>

<h1 id="gravity-estimation-methodology">Gravity Estimation Methodology</h1>
<h2 id="theory-based-gravity-equation">Theory-based gravity equation</h2>
<p>The GME module estimates the <a href="https://www.wto.org/english/res_e/publications_e/advancedguide2016_e.htm">structural gravity equation</a> \eqref{eq:gravity} using the Poisson Pseudo Maximum Likelihood (PPML) estimator, a special case of the the Generalized Linear Model (GLM) framework.</p>
<div>
<div class="MathJax_Preview">\begin{equation}
    X_{ij} =\frac{Y_i E_j}{Y}\left(\frac{t_{ij}}{S_i P_j}\right)^{1-\sigma}.
    \label{eq:gravity}
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
    X_{ij} =\frac{Y_i E_j}{Y}\left(\frac{t_{ij}}{S_i P_j}\right)^{1-\sigma}.
    \label{eq:gravity}
\end{equation}</script>
</div>
<p>In this equation, <span><span class="MathJax_Preview">X_{ij}</span><script type="math/tex">X_{ij}</script></span> are the value of exports from country <span><span class="MathJax_Preview">i</span><script type="math/tex">i</script></span> to country <span><span class="MathJax_Preview">j</span><script type="math/tex">j</script></span>, <span><span class="MathJax_Preview">Y_{i}</span><script type="math/tex">Y_{i}</script></span> is country <span><span class="MathJax_Preview">i</span><script type="math/tex">i</script></span>'s domestic production, <span><span class="MathJax_Preview">E_{j}</span><script type="math/tex">E_{j}</script></span> is country <span><span class="MathJax_Preview">j</span><script type="math/tex">j</script></span>'s aggregate expenditure, <span><span class="MathJax_Preview">Y</span><script type="math/tex">Y</script></span> is global production, <span><span class="MathJax_Preview">t_{ij}</span><script type="math/tex">t_{ij}</script></span> is the bilateral cost of trading between country <span><span class="MathJax_Preview">i</span><script type="math/tex">i</script></span> and country <span><span class="MathJax_Preview">j</span><script type="math/tex">j</script></span>, and <span><span class="MathJax_Preview">\sigma\</span><script type="math/tex">\sigma\</script></span> is the elasticity of substitution among goods from varying source countries. The structural terms <span><span class="MathJax_Preview">S_{i}</span><script type="math/tex">S_{i}</script></span> and <span><span class="MathJax_Preview">P_{j}</span><script type="math/tex">P_{j}</script></span> represent multilateral resistance within the exporting and importing countries (i.e the ease of market access for country <span><span class="MathJax_Preview">i</span><script type="math/tex">i</script></span>'s export, and the ease of market access for country <span><span class="MathJax_Preview">j</span><script type="math/tex">j</script></span>'s imports, respectively). </p>
<p>When applying equation \eqref{eq:gravity} to data using PPML, a variety of fixed effects are possible. One theory-consistent and flexible empirical form of the gravity equation when using panel data is</p>
<div>
<div class="MathJax_Preview">\begin{equation}
    X_{ijt} =\exp \left[\gamma_{it}+\eta_{jt}+\lambda_{ij}+\beta Z_{ijt}\right]+\varepsilon_{ijt}
    \label{eq:PPML_gravity_panel}
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
    X_{ijt} =\exp \left[\gamma_{it}+\eta_{jt}+\lambda_{ij}+\beta Z_{ijt}\right]+\varepsilon_{ijt}
    \label{eq:PPML_gravity_panel}
\end{equation}</script>
</div>
<p>In equation \eqref{eq:PPML_gravity_panel}, <span><span class="MathJax_Preview">\gamma_{it}</span><script type="math/tex">\gamma_{it}</script></span> are exporter time-varying fixed effect, <span><span class="MathJax_Preview">\eta_{jt}</span><script type="math/tex">\eta_{jt}</script></span> are importer time-varying fixed effects, <span><span class="MathJax_Preview">\lambda_{ij}</span><script type="math/tex">\lambda_{ij}</script></span> are exporter-importer time-invariant fixed effects, and <span><span class="MathJax_Preview">Z_{ijt}</span><script type="math/tex">Z_{ijt}</script></span> is the vector of time-variant bilateral determinants of trade, such as tariff levels.</p>
<p>If only cross-section data is available, a theory-consistent empirical form of the gravity equation could be</p>
<div>
<div class="MathJax_Preview">\begin{equation}
    X_{ij} =\exp \left[\gamma_{i}+\eta_{j}+\beta Z_{ij}\right]+\varepsilon_{ij}
    \label{eq:PPML_gravity_cross}
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
    X_{ij} =\exp \left[\gamma_{i}+\eta_{j}+\beta Z_{ij}\right]+\varepsilon_{ij}
    \label{eq:PPML_gravity_cross}
\end{equation}</script>
</div>
<p>In this case, <span><span class="MathJax_Preview">\gamma_{it}</span><script type="math/tex">\gamma_{it}</script></span> are exporter fixed effect, <span><span class="MathJax_Preview">\eta_{jt}</span><script type="math/tex">\eta_{jt}</script></span> are importer fixed effects, and <span><span class="MathJax_Preview">Z_{ij}</span><script type="math/tex">Z_{ij}</script></span> is the vector of bilateral determinants of trade, such as distance.</p>
<h2 id="estimation-procedure">Estimation Procedure</h2>
<p>The method <strong><em>estimate</em></strong> performs a sector-by-sector GLM estimation based on a Poisson distribution with data diagnostics that help increase the likelihood of convergence. See <a href="../api_docs/estimate_method/">estimate</a>.  If sector_by_sector is specified, the routine is repeated for each sector individually, estimating a separate model each time. The estimate routine inherits all specifications from those supplied to the <em>EstimationModel</em>.</p>
<h2 id="technical-details-of-ppml-implementation">Technical Details of PPML Implementation</h2>
<p>We implement PPML following <a href="https://www.mitpressjournals.org/doi/pdf/10.1162/rest.88.4.641">Santos Silva and Tenreyro (2006)</a>. The PPML assumes that the variance is proportional to the mean so that the only condition required for PPML to be consistent is the correct specification of the conditional mean. The PPML also gives the same weight to each observation in the estimation and so is desirable when there is not much available information on the nature of heteroscedasticity in the trade data. <a href="https://www.mitpressjournals.org/doi/pdf/10.1162/rest.88.4.641">Santos Silva and Tenreyro (2006)</a> provide simulation evidence that the PPML is well behaved in a wide range of situations and can deal with certain types of measurement error in the dependent variable. The PPML, being a non-linear estimator, is also able to handle zero trade flows in the estimation.</p>
<p>Common problems with PPML estimation include the non-existence of estimates due to perfect collinearity and numerical difficulties in running the algorithm.</p>
<h3 id="non-existence-of-estimates">Non-existence of estimates</h3>
<p><a href="https://www.sciencedirect.com/science/article/pii/S0165176510000832?via%3Dihub">Santos Silva and Tenreyro (2010)</a> show that PPML estimates may not exist if there is perfect collinearity for the subsample with positive observations of the dependent variable (common in trade data where some countries do not trade in certain years or sectors and so are perfectly collinear when <span><span class="MathJax_Preview">X_{ij}&gt;0</span><script type="math/tex">X_{ij}>0</script></span>). In this scenario, either the estimation algorithm will fail to converge or convergence is spurious and characterized by a “perfect” fit for observations where <span><span class="MathJax_Preview">X_{ij}=0</span><script type="math/tex">X_{ij}=0</script></span>. To check for non-existence, <a href="https://www.stata-journal.com/article.html?article=st0225">Santos Silva and Tenreyro (2011)</a> use a short STATA code that first identifies and drops the problematic regressors before estimating it with PPML. Their code also issues a warning that the model is overfitting due to spurious convergence. We implement their STATA code in Python in order to obtain the same procedures for identifying and dropping problematic variables, testing for perfect collinearity and checking if the <span><span class="MathJax_Preview">X_{ij}=0</span><script type="math/tex">X_{ij}=0</script></span> observations are perfectly predicted by the estimated model. All these diagnostics are stored as PPML diagnostics and available to the user after every GME estimation.</p>
<h3 id="non-convergence">Non-convergence</h3>
<p><a href="https://www.stata-journal.com/article.html?article=st0225">Santos Silva and Tenreyro (2011)</a> also find that sensitivity to numerical problems can prevent estimation algorithms from locating the maximum and finding PPML estimates that converge. In particular, these numerical issues arise when there are collinear regressors that have different magnitudes or regressors that are extremely, but not perfectly collinear. They recommend using the iterated, re-weighted least squares (IRLS) as the optimization algorithm to deal with such numerical complications, which is also the default method for GLM estimation in the <a href="https://www.statsmodels.org">statsmodels</a> package used by GME. Thus, the PPML estimator in GME is robust to numerical problems arising from different data configurations.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../estimation_tutorial/" title="Estimation" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Estimation
              </span>
            </div>
          </a>
        
        
          <a href="../api_docs/EstimationData/" title="EstimationData" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                EstimationData
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.b438e6c5.js"></script>
      
      <script>app.initialize({version:"0.17.3",url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>